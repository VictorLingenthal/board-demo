(this.webpackJsonpboard=this.webpackJsonpboard||[]).push([[0],{103:function(t,e,n){},104:function(t,e,n){},105:function(t,e,n){"use strict";n.r(e);var r=n(5),a=n(2),c=n.n(a),i=n(26),u=n.n(i),o=(n(73),n(74),n(17)),s=(n(75),n(20)),l=n(18),d=n(40),f=n(64);function b(){var t=[],e=function(){var e,n=Object(f.a)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.apply(void 0,arguments)}}catch(a){n.e(a)}finally{n.f()}};return e.add=function(e){t=[].concat(Object(l.a)(t),[e])},e.remove=function(e){t=t.filter((function(t){return t!==e}))},e}function j(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=t,c=b(),i=Object.keys(e).reduce((function(t,a){return Object(s.a)(Object(s.a)({},t),{},Object(d.a)({},a,(function(){for(var t=arguments.length,i=new Array(t),u=0;u<t;u++)i[u]=arguments[u];var o=e[a].apply(e,[r].concat(i));r!==o&&(r=o,c(o),n&&n(o))})))}),{});return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=Object(a.useState)(t?t(r):r),u=Object(o.a)(n,2),s=u[0],l=u[1];return Object(a.useEffect)((function(){var n=function(n){var r=t?t(n):n;r!==s&&(l(r),e&&e(r))};return c.add(n),function(){c.remove(n)}}),[s]),[s,i]}}var v=j([],{deleteCard:function(t,e){return t.filter((function(t){return t.id!==e}))},addCard:function(t,e){return[e].concat(Object(l.a)(t))},addCards:function(t,e){return[].concat(Object(l.a)(e),Object(l.a)(t))},setStatus:function(t,e,n){return t.map((function(t){return t.id===e?Object(s.a)(Object(s.a)({},t),{},{status:n}):t}))},setTitle:function(t,e,n){return t.map((function(t){return t.id===e?Object(s.a)(Object(s.a)({},t),{},{title:n}):t}))},setOwner:function(t,e,n){return t.map((function(t){return t.id===e?Object(s.a)(Object(s.a)({},t),{},{owner:n}):t}))}}),h=j([],{addUser:function(t,e){return[e].concat(Object(l.a)(t))},addUsers:function(t,e){return[].concat(Object(l.a)(e),Object(l.a)(t))},deleteUser:function(t,e){return t.filter((function(t){return t.id!==e}))}}),O=n(23),m=n(29),p=n(30),g=function(){function t(){var e=this;Object(m.a)(this,t),this.statusTypes=void 0,this.getStatusByValue=function(t){return e.statusTypes.filter((function(e){return e.value===t}))[0]},this.statusTypes=[{value:"backlog",label:"Backlog"},{value:"todo",label:"To Do"},{value:"inprogress",label:"In Progress"},{value:"resolved",label:"Resolved"},{value:"won't fix",label:"Won't Fix"}]}return Object(p.a)(t,null,[{key:"getInstance",value:function(){return t.instance||(t.instance=new t),t.instance}}]),t}();g.instance=void 0;var C=n(19);function x(){var t=Object(O.a)(["\n        mutation DeleteCard($id: ID) {\n          deleteCard(id: $id)\n        }"]);return x=function(){return t},t}function S(){var t=Object(O.a)(["\n        mutation UpdateCard($id: ID, $card:CardInput) {\n          updateCard(id: $id, card:$card) {\n            title\n            id\n            status\n            owner\n            creator\n            date\n          }\n        }"]);return S=function(){return t},t}function T(){var t=Object(O.a)(["\n          mutation AddCard($status: String) {\n            addCard(status: $status) {\n              title\n              id\n              status\n              owner\n              creator\n              date\n            }\n          }"]);return T=function(){return t},t}function w(){var t=Object(O.a)(["{\n            cards {\n              title\n              id\n              status\n              owner\n              creator\n              date\n            }\n          }"]);return w=function(){return t},t}var y=function(){function t(e,n){var r=this;Object(m.a)(this,t),this.dispatcher=void 0,this.titleTimeouts=void 0,this.apolloClient=void 0,this.convertServerCard=function(t){return{id:t.id,title:t.title,status:g.getInstance().getStatusByValue(t.status),owner:t.owner,creator:t.creator,date:t.date}},this.getCards=function(){return r.apolloClient.query({query:Object(C.gql)(w())}).then((function(t){return r.dispatcher.addCards(t.data.cards.map((function(t){return r.convertServerCard(t)})))})).catch((function(t){return console.log(t)}))},this.addCard=function(t){return r.apolloClient.mutate({variables:{status:t.value},mutation:Object(C.gql)(T())}).then((function(t){return r.dispatcher.addCard(r.convertServerCard(t.data.addCard))})).catch((function(t){return console.log("Error: "+t)}))},this.update=function(t,e){return r.apolloClient.mutate({variables:{id:t,card:e},mutation:Object(C.gql)(S())}).then((function(t){})).catch((function(t){return console.log("Error: "+t)}))},this.updateStatus=function(t,e){return r.dispatcher.setStatus(t,e),r.update(t,{status:e.value})},this.updateOwner=function(t,e){var n=e?e.value:null;return r.dispatcher.setOwner(t,n),r.update(t,{owner:n})},this.updateTitle=function(t,e,n){var a=r.titleTimeouts.filter((function(e){return e.id===t}))[0],c=function(){return setTimeout((function(){return r.titleTimeouts=r.titleTimeouts.filter((function(e){return!(e.id===t)})),r.update(t,{title:n})}),2e3)};if(a)clearTimeout(a.timeout),a.timeout=c();else{var i={id:t,oldTitle:e,timeout:c()};r.titleTimeouts=[i].concat(Object(l.a)(r.titleTimeouts))}r.dispatcher.setTitle(t,n)},this.deleteCard=function(t){return r.apolloClient.mutate({variables:{id:t},mutation:Object(C.gql)(x())}).then((function(){return r.dispatcher.deleteCard(t)})).catch((function(t){return console.log(t)}))},this.dispatcher=e,this.apolloClient=n,this.titleTimeouts=[]}return Object(p.a)(t,null,[{key:"getInstance",value:function(e,n){return!t.instance&&n&&(t.instance=new t(e,n)),t.instance}}]),t}();function U(){var t=Object(O.a)(["\n          mutation DeleteUser($id: ID) {\n            deleteUser(id: $id)\n          }"]);return U=function(){return t},t}function I(){var t=Object(O.a)(["\n        mutation AddUser($name: String) {\n          addUser(name: $name) {\n            id\n            name\n          }\n        }"]);return I=function(){return t},t}function k(){var t=Object(O.a)(["{\n          users {\n            name\n            id\n          }\n        }"]);return k=function(){return t},t}y.instance=void 0;var N=function(t){return t.map((function(t){return{value:t.name,label:t.name,id:t.id}}))},q=function(){function t(e){var n=this;Object(m.a)(this,t),this.apolloClient=void 0,this.getUsers=function(t){return n.apolloClient.query({query:Object(C.gql)(k())}).then((function(e){return t(N(e.data.users))})).catch((function(t){return console.log(t)}))},this.addUser=function(t,e){return n.apolloClient.mutate({variables:{name:e},mutation:Object(C.gql)(I())}).then((function(e){return t(N([e.data.addUser]))})).catch((function(t){return console.log(t)}))},this.deleteUser=function(t,e){return e?n.apolloClient.mutate({variables:{id:e},mutation:Object(C.gql)(U())}).then((function(n){return t(e)})).catch((function(t){return console.log(t)})):null},this.apolloClient=e}return Object(p.a)(t,null,[{key:"getInstance",value:function(e){return!t.instance&&e&&(t.instance=new t(e)),t.instance}}]),t}();q.instance=void 0;var $=new C.ApolloClient({cache:new C.InMemoryCache({addTypename:!1}),uri:"/graphql"}),D=(n(83),n(35)),A=function(){var t=h(),e=Object(o.a)(t,2),n=e[0],c=e[1],i=c.addUser,u=c.deleteUser,s=Object(a.useState)(),l=Object(o.a)(s,2),d=l[0],f=l[1],b=Object(a.useState)(),j=Object(o.a)(b,2),v=j[0],O=j[1];return Object(r.jsxs)("header",{className:"boardHeader",children:[Object(r.jsx)("input",{placeholder:"New Username",value:d,onChange:function(t){return f(t.currentTarget.value)}}),Object(r.jsx)("button",{onClick:function(){d&&q.getInstance().addUser(i,d),f("")},children:"Add User"}),Object(r.jsx)(D.a,{className:"deleteUser",options:n,value:v,placeholder:"Pick User",isClearable:!0,onChange:function(t){return O(t)}}),Object(r.jsx)("button",{onClick:function(){return q.getInstance().deleteUser(u,v?v.id:"")},children:"Delete User"})]})},B=(n(103),n(104),n(67));var E,F=function(t){return"string"!==typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)},P=function(t){var e=Object(a.useState)(!1),n=Object(o.a)(e,2),c=n[0],i=n[1],u=Object(a.useState)(!1),s=Object(o.a)(u,2),l=s[0],d=s[1],f=function(){return i(!c)},b=t.cardService;return Object(r.jsxs)("div",{className:"card ".concat(l?"deletePending":""),children:[Object(r.jsxs)("header",{children:[Object(r.jsx)(D.a,{className:"selectOwner",options:t.users,value:{value:t.model.owner,label:F(t.model.owner)},placeholder:"Owner",isClearable:!0,onChange:function(e){return b.updateOwner(t.model.id,e)}}),Object(r.jsx)(D.a,{className:"selectStatus",options:g.getInstance().statusTypes,value:t.model.status,placeholder:"Status",onChange:function(e){return b.updateStatus(t.model.id,e)}})]}),Object(r.jsxs)("main",{children:[!c&&Object(r.jsx)("div",{onClick:f,children:t.model.title}),c&&Object(r.jsx)(B.a,{placeholder:"Enter Title",autoFocus:!0,value:t.model.title,onChange:function(e){return b.updateTitle(t.model.id,t.model.title,e.currentTarget.value)},onBlur:f})]}),Object(r.jsx)("button",{className:"deleteButton",onClick:function(){d(!0),b.deleteCard(t.model.id).catch((function(t){return console.log(t)})).finally((function(){return d(!1)}))},children:"X"})]})},M=function(t){return Object(r.jsxs)("div",{className:"column",children:[Object(r.jsxs)("header",{className:"columnHeader",children:[t.status.label,Object(r.jsx)("button",{onClick:function(){return t.cardService.addCard(t.status)},children:"+"})]}),Object(r.jsx)("main",{className:"columnMain",children:t.cards.filter((function(e){return e.status.value===t.status.value})).map((function(e){return Object(r.jsx)(P,{model:e,cardService:t.cardService,users:t.users},e.id)}))})]})},H=function(){var t=v(),e=Object(o.a)(t,2),n=e[0],c=e[1],i=h(),u=Object(o.a)(i,2),s=u[0],l=u[1].addUsers;Object(a.useEffect)((function(){(E=y.getInstance(c,$)).getCards(),q.getInstance($).getUsers(l)}),[]);var d=g.getInstance().statusTypes.map((function(t){return Object(r.jsx)(M,{status:t,users:s,cards:n,cardService:E},t.label)}));return Object(r.jsxs)("div",{className:"board",children:[Object(r.jsx)(A,{}),Object(r.jsx)("main",{className:"boardmain",children:d})]})};var J=function(){return Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(H,{})})})},L=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,107)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),r(t),a(t),c(t),i(t)}))};u.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(J,{})}),document.getElementById("root")),L()},73:function(t,e,n){},74:function(t,e,n){},75:function(t,e,n){},83:function(t,e,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.1540977e.chunk.js.map